import re
import matplotlib.pyplot as plt

# Paste your training log here
log_content = """
    100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:1 | Loss : 0.1732
100%|██████████| 329/329 [02:25<00:00,  2.26it/s]
Epoch:2 | Loss : 0.0609
100%|██████████| 329/329 [02:25<00:00,  2.26it/s]
Epoch:3 | Loss : 0.0459
100%|██████████| 329/329 [02:27<00:00,  2.22it/s]
Epoch:4 | Loss : 0.0383
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:5 | Loss : 0.0352
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:6 | Loss : 0.0328
100%|██████████| 329/329 [02:26<00:00,  2.25it/s]
Epoch:7 | Loss : 0.0311
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:8 | Loss : 0.0299
100%|██████████| 329/329 [02:27<00:00,  2.24it/s]
Epoch:9 | Loss : 0.0290
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:10 | Loss : 0.0281
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:11 | Loss : 0.0271
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:12 | Loss : 0.0267
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:13 | Loss : 0.0263
100%|██████████| 329/329 [02:27<00:00,  2.24it/s]
Epoch:14 | Loss : 0.0258
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:15 | Loss : 0.0257
100%|██████████| 329/329 [02:27<00:00,  2.24it/s]
Epoch:16 | Loss : 0.0254
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:17 | Loss : 0.0250
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:18 | Loss : 0.0249
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:19 | Loss : 0.0242
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:20 | Loss : 0.0246
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:21 | Loss : 0.0244
100%|██████████| 329/329 [02:27<00:00,  2.24it/s]
Epoch:22 | Loss : 0.0243
100%|██████████| 329/329 [02:27<00:00,  2.24it/s]
Epoch:23 | Loss : 0.0242
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:24 | Loss : 0.0239
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:25 | Loss : 0.0238
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:26 | Loss : 0.0236
100%|██████████| 329/329 [02:27<00:00,  2.22it/s]
Epoch:27 | Loss : 0.0236
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:28 | Loss : 0.0237
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:29 | Loss : 0.0235
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:30 | Loss : 0.0235
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:31 | Loss : 0.0228
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:32 | Loss : 0.0232
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:33 | Loss : 0.0231
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:34 | Loss : 0.0231
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:35 | Loss : 0.0228
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:36 | Loss : 0.0227
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:37 | Loss : 0.0227
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:38 | Loss : 0.0229
100%|██████████| 329/329 [02:27<00:00,  2.24it/s]
Epoch:39 | Loss : 0.0228
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:40 | Loss : 0.0224
100%|██████████| 329/329 [02:27<00:00,  2.24it/s]
Epoch:41 | Loss : 0.0225
100%|██████████| 329/329 [02:26<00:00,  2.25it/s]
Epoch:42 | Loss : 0.0224
100%|██████████| 329/329 [02:27<00:00,  2.24it/s]
Epoch:43 | Loss : 0.0225
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:44 | Loss : 0.0225
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:45 | Loss : 0.0222
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:46 | Loss : 0.0227
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:47 | Loss : 0.0227
100%|██████████| 329/329 [02:27<00:00,  2.23it/s]
Epoch:48 | Loss : 0.0230
100%|██████████| 329/329 [02:27<00:00,  2.24it/s]
Epoch:49 | Loss : 0.0220
100%|██████████| 329/329 [02:26<00:00,  2.24it/s]
Epoch:50 | Loss : 0.0221
"""

# Parse the log
epochs, losses = [], []
for line in log_content.split('\n'):
    match = re.search(r'Epoch:(\d+)\s*\|\s*Loss\s*:\s*([\d.]+)', line)
    if match:
        epochs.append(int(match.group(1)))
        losses.append(float(match.group(2)))

# Create plot
plt.figure(figsize=(10, 6))
plt.plot(epochs, losses, marker='o', linewidth=2, markersize=6, color='#2E86AB')
plt.xlabel('Epoch', fontsize=12)
plt.ylabel('Loss', fontsize=12)
plt.title('Training Loss Over Epochs', fontsize=14, fontweight='bold')
plt.grid(True, alpha=0.3, linestyle='--')
plt.tight_layout()
plt.show()

print(f"Plotted {len(epochs)} epochs from {min(epochs)} to {max(epochs)}")
